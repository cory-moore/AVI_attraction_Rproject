"Asian" = "4",
"Native Hawaiian or Pacific Islander" = "5",
"Other" = "6",
"Prefer not to respond" = "7"))
scales$Employment <- as.numeric(recode(scales$Employment,
"Employed full time" = "1",
"Employed part time" = "2",
"Unemployed looking for work" = "3",
"Unemployed not looking for work" = "4",
"Retired" = "5",
"Student" = "6"))
scales$Age <- as.numeric(scales$Age)
scales$Condition <- NULL
mod1 <- lm(Justice ~ AVI, data=scales)
summary(mod1)
#libraries
library(psych)
library(car)
library(dplyr)
library(ggplot2)
library(apaTables)
library(corrplot)
library(Hmisc)
library(ggcorrplot)
library(xlsx)
library(mediation)
library(tidyr)
#import data
scales <- read.csv("data/cleaned_scaledata_long.csv", header=TRUE)
#rename and recode
scales <- scales %>%
rename(id = id,
Sex = sex,
Ethnicity = ethnicity,
Age = age,
Employment = employ1,
Condition = condition,
AVI = AVI.id,
P_Justice=procjust,
I_Justice=interjust,
Justice=orgjust,
G_Attraction = genatrct,
Pursuit = intpurs,
Prestige = prest,
Attraction = orgatrct,
Competitiveness =compete,
Responsibility = socresp,
Supportiveness = support,
Innovativeness = innovate)
scales$Sex <- as.numeric(recode(scales$Sex,
"Male" = "1",
"Female" = "2",
"Other" = "3",
"Prefer not to respond" = "4"))
scales$Ethnicity <- as.numeric(recode(scales$Ethnicity,
"White" = "1",
"Black or African American" = "2",
"American Indian or Alaska Native" = "3",
"Asian" = "4",
"Native Hawaiian or Pacific Islander" = "5",
"Other" = "6",
"Prefer not to respond" = "7"))
scales$Employment <- as.numeric(recode(scales$Employment,
"Employed full time" = "1",
"Employed part time" = "2",
"Unemployed looking for work" = "3",
"Unemployed not looking for work" = "4",
"Retired" = "5",
"Student" = "6"))
scales$Age <- as.numeric(scales$Age)
scales$Condition <- NULL
###### REGRESSIONs ######
max.mod <- lm(Attraction ~ AVI + Justice + Innovativeness + Supportiveness + Responsibility + Competitiveness, data = scales)
mod1 <- lm(Justice ~ AVI, data=scales)
mod2 <- lm(Competitiveness ~ AVI, data=scales)
mod3 <- lm(Responsibility ~ AVI, data=scales)
mod4 <- lm(Innovativeness ~ AVI, data=scales)
mod5 <- lm(Supportiveness ~ AVI, data=scales)
mod6 <- lm(Attraction ~ AVI, data=scales)
mod7 <- lm(Attraction ~ Justice, data=scales)
mod8 <- lm(Attraction ~ Competitiveness, data=scales)
mod9 <- lm(Attraction ~ Responsibility, data=scales)
mod10 <- lm(Attraction ~ Innovativeness, data=scales)
mod11 <- lm(Attraction ~ Supportiveness, data=scales)
#multiple regressions needed for meditate()
mod12 <- lm(Attraction ~ AVI + Competitiveness, data=scales)
mod13 <- lm(Attraction ~ AVI + Responsibility, data=scales)
mod14 <- lm(Attraction ~ AVI + Supportiveness, data=scales)
mod15 <- lm(Attraction ~ AVI + Innovativeness, data=scales)
mod16 <- lm(Attraction ~ AVI + Justice, data=scales)
# x = AVI, m = OCP dimensions, y = attraction
me1 <- mediation::mediate(mod2, mod12, treat="AVI", mediator="Competitiveness",sims=500, dropobs=TRUE)
summary(me1)
me2 <- mediation::mediate(mod3, mod13, treat="AVI", mediator="Responsibility",sims=500, dropobs=TRUE)
summary(me2)
me3 <- mediation::mediate(mod5, mod14, treat="AVI", mediator="Supportiveness",sims=500, dropobs=TRUE)
summary(me3)
me4 <- mediation::mediate(mod4, mod15, treat="AVI", mediator="Innovativeness",sims=500, dropobs=TRUE)
summary(me4)
# x = AVI, m = Justice, y = attraction
me5 <- mediation::mediate(mod1, mod16, treat="AVI", mediator="Justice",sims=500, dropobs=TRUE)
summary(me5)
###### REGRESSIONs ######
max.mod <- lm(Attraction ~ AVI + Justice + Innovativeness + Supportiveness + Responsibility + Competitiveness, data = scales)
summary(max.mod)
setwd("/Volumes/GoogleDrive/My Drive/1. Professional/Doctoral work/a. Coursework/Advanced Methods in Psychology/Research - 5 - Factorial experiment")
#import the dataset 'visual.csv'
visual <- read.csv("data/visual.csv", header=TRUE)
View(visual)
#view data
View(visual)
describe(visual)
#libraries
library(psych)
describe(visual)
#make categorical variables (target, distractor, number) factor variables
visual <- as.factor(visual[,2:4])
#import the dataset 'visual.csv'
visual <- read.csv("data/visual.csv", header=TRUE)
#make categorical variables (target, distractor, number) factor variables
visual[,2:4] <- as.factor(visual[,2:4])
#import the dataset 'visual.csv'
visual <- read.csv("data/visual.csv", header=TRUE)
#import the dataset 'visual.csv'
visual <- read.csv("data/visual.csv", header=TRUE, stringsAsFactors = TRUE)
#view data
View(visual)
describe(visual)
## fit one-way ANOVA models
aov1 <- aov(MeanScore ~ target, data=visual)
## fit one-way ANOVA models
aov1 <- aov(MeanScore ~ Target, data=visual)
summary(aov1)
aov2 <- aov(MeanScore ~ Distractor, data=visual)
summary(aov2)
## DV = MeanScore, IV = Number few or many
aov3 <- aov(MeanScore ~ Number, data=visaul)
## DV = MeanScore, IV = Number few or many
aov3 <- aov(MeanScore ~ Number, data=visual)
summary(visual)
summary(aov3)
" Next, we will do two- and three-way ANOVAs by adding additional factors (IVs) and interactions"
" Next, we will do two- and three-way ANOVAs by adding additional factors (IVs) and interactions.
But first, lets plot the interactions for those upcoming ANOVA models"
interaction.plot(x.factor = visual$Target, #x-axis variable
trace.factor = visual$Distractor, #variable for lines
response = visual$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence",
xlab = "Target (Absent or Present",
trace.label = "Distractor")
interaction.plot(x.factor = visual$Target, #x-axis variable
trace.factor = visual$Distractor, #variable for lines
response = visual$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
?interaction.plot
visual %>%
ggplot(aes(Target, MeanScore)) +
geom_line(aes(group = Distractor, color = Distractor)) +
geom_point(aes(color = Distractor))
#libraries
library(ggplot2)
glimpse(visual)
library(dplyr)
glimpse(visual)
visual %>%
ggplot(aes(Target, MeanScore)) +
geom_line(aes(group = Distractor, color = Distractor)) +
geom_point(aes(color = Distractor))
visual %>%
ggplot(aes(Target, MeanScore)) +
geom_line(aes(group = Distractor)) +
geom_point()
visual %>%
ggplot(aes(Target, MeanScore, color = Distractor)) +
geom_line(aes(group = Distractor)) +
geom_point()
visual.num <- visual %>% filter(Number == few)
visual.num <- visual %>% filter(Number == "few")
View(visual.num)
interaction.plot(x.factor = visual.num$Target, #x-axis variable
trace.factor = visual.num$Distractor, #variable for lines
response = visual.num$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
interaction.plot(x.factor = visual.few$Target, #x-axis variable
trace.factor = visual.few$Distractor, #variable for lines
response = visual.few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
visual.few <- visual %>% filter(Number == "few")
interaction.plot(x.factor = visual.few$Target, #x-axis variable
trace.factor = visual.few$Distractor, #variable for lines
response = visual.few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
few <- visual %>% filter(Number == "few")
interaction.plot(x.factor = few$Target, #x-axis variable
trace.factor = few$Distractor, #variable for lines
response = few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
interaction.plot(x.factor = few$Target, #x-axis variable
trace.factor = few$Distractor, #variable for lines
response = few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
many <- visual %>% filter(Number == "many")
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
?interaction.plot
interaction.plot(x.factor = few$Target, #x-axis variable
trace.factor = few$Distractor, #variable for lines
response = few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor")
interaction.plot(x.factor = few$Target, #x-axis variable
trace.factor = few$Distractor, #variable for lines
response = few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor",
main = "Interaction plot: Distractor x Target (when Number = few)")
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor",
main = "Interaction plot: Distractor x Target (when Number = many)")
# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor",
main = "Interaction plot: Distractor x Target (when Number = many)")
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = few$Target, #x-axis variable
trace.factor = few$Distractor, #variable for lines
response = few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor",
main = "Interaction plot: Distractor x Target (when Number = few)",
col = c("red", "blue"))
# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)",
xlab = "Target (Absent or Present)",
trace.label = "Distractor",
main = "Interaction plot: Distractor x Target (when Number = many)",
col = c("red", "blue"))
# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Target (Absent or Present)", #x-axis label
trace.label = "Distractor", #Legend label
main = "Interaction plot: Distractor x Target (when Number = many)", #main title
col = c("red", "blue")) #adds color to the lines
# this creates a new dataframe containing only trials with few distractors
# used in the following interaction plot
absent <- visual %>% filter(Target == "absent")
# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Target (Absent or Present)", #x-axis label
trace.label = "Distractor", #Legend label
main = "Interaction plot: Distractor x Target (when Number = many)", #main title
col = c("red", "blue")) #adds color to the lines
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = absent$Distractor, #x-axis variable
trace.factor = absent$Number, #variable for lines
response = absent$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Distractor (O or Y)", #x-axis label
trace.label = "Number", #legend label
main = "Interaction plot: Distractor x Target (when Number = few)", #main title
col = c("red", "blue")) #adds color to the lines
# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Target (Absent or Present)", #x-axis label
trace.label = "Distractor", #Legend label
main = "Interaction plot: Distractor x Target (when Number = many)", #main title
col = c("red", "blue")) #adds color to the lines
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = absent$Distractor, #x-axis variable
trace.factor = absent$Number, #variable for lines
response = absent$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Distractor (O or Y)", #x-axis label
trace.label = "Number", #legend label
main = "Interaction plot: Distractor x Target (when Number = few)", #main title
col = c("red", "blue")) #adds color to the lines
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = absent$Distractor, #x-axis variable
trace.factor = absent$Number, #variable for lines
response = absent$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Distractor (O or Y)", #x-axis label
trace.label = "Number", #legend label
main = "Interaction plot: Distractor x Number (when Target = absent)", #maintitle
col = c("red", "blue")) #adds color to the lines
# this creates a new dataframe containing only trials with many distractors
# used in the following interaction plot
present <- visual %>% filter(Target == "present")
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = present$Distractor, #x-axis variable
trace.factor = present$Number, #variable for lines
response = present$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Distractor (O or Y)", #x-axis label
trace.label = "Number", #legend label
main = "Interaction plot: Distractor x Number (Target = present)", #maintitle
col = c("red", "blue")) #adds color to the lines
summary(aov3)
aov4 <- aov(MeanScore ~ Target + Distractor + Number, data=visual)
summary(aov4)
aov4 <- aov(MeanScore ~ Target * Distractor * Number, data=visual)
summary(aov4)
### IMPORT the dataset 'visual.csv'
## select header=TRUE and stringsAsFactors=TRUE
## imports categorical variables (target, distractor, number) as factors
visual <- read.csv("data/visual.csv", header=TRUE, stringsAsFactors = TRUE)
View(visual)
## DV = MeanScore, IV = Target absence or presence
aov1 <- aov(MeanScore ~ Target, data=visual)
summary(aov1)
## DV = MeanScore, IV = Distractor O's or Y's
aov2 <- aov(MeanScore ~ Distractor, data=visual)
summary(aov2)
## DV = MeanScore, IV = Number few or many
aov3 <- aov(MeanScore ~ Number, data=visual)
summary(aov3)
# this creates a new dataframe containing only trials with few distractors
# used in the following interaction plot
few <- visual %>% filter(Number == "few")
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = few$Target, #x-axis variable
trace.factor = few$Distractor, #variable for lines
response = few$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Target (Absent or Present)", #x-axis label
trace.label = "Distractor", #legend label
main = "Interaction plot: Target x Distractor (when Number = few)", #main title
col = c("red", "blue")) #adds color to the lines
# this creates a new dataframe containing only trials with many distractors
# used in the following interaction plot
many <- visual %>% filter(Number == "many")
# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
trace.factor = many$Distractor, #variable for lines
response = many$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Target (Absent or Present)", #x-axis label
trace.label = "Distractor", #Legend label
main = "Interaction plot: Target x Distractor (when Number = many)", #main title
col = c("red", "blue")) #adds color to the lines
# this creates a new dataframe containing only trials with few distractors
# used in the following interaction plot
absent <- visual %>% filter(Target == "absent")
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = absent$Distractor, #x-axis variable
trace.factor = absent$Number, #variable for lines
response = absent$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Distractor (O or Y)", #x-axis label
trace.label = "Number", #legend label
main = "Interaction plot: Distractor x Number (Target = absent)", #maintitle
col = c("red", "blue")) #adds color to the lines
# this creates a new dataframe containing only trials with many distractors
# used in the following interaction plot
present <- visual %>% filter(Target == "present")
# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = present$Distractor, #x-axis variable
trace.factor = present$Number, #variable for lines
response = present$MeanScore, #y-axis variable
fun = mean, #metric to plot
ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
xlab = "Distractor (O or Y)", #x-axis label
trace.label = "Number", #legend label
main = "Interaction plot: Distractor x Number (Target = present)", #maintitle
col = c("red", "blue")) #adds color to the lines
scales <- read.csv("data/cleaned_scaledata_long.csv", header=TRUE)
##### examine distributions of variables
hist(scales$procjust)
densityPlot(scales$procjust)
vif <- lm(orgjust ~ compete + support + socresp + innovate, data=scales)
vif(vif)
car::vif(vif)
vif <- lm(orgjust ~ AVI + compete + support + socresp + innovate, data=scales)
vif <- lm(orgjust ~ AVI.id + compete + support + socresp + innovate, data=scales)
car::vif(vif)
##### examine distributions of variables
hist(scales$procjust)
scales <- read.csv("data/cleaned_scaledata_long.csv", header=TRUE)
##### examine distributions of variables
hist(scales$procjust)
densityPlot(scales$procjust)
library(car)
densityPlot(scales$procjust)
hist(scales$interjust)
densityPlot(scales$interjust)
?hist
##### examine distributions of variables
hist(scales$procjust, breaks=20)
##### examine distributions of variables
hist(scales$procjust, breaks=20)
hist(scales$interjust, breaks=20)
hist(scales$orgjust, breaks=20)
hist(scales$genatrct, breaks=20)
densityPlot(scales$genatrct)
hist(scales$intpurs, , breaks=20)
hist(scales$intpurs, breaks=20)
densityPlot(scales$intpurs)
hist(scales$prest, breaks=20)
densityPlot(scales$prest)
hist(scales$orgatrct, breaks=20) #skewed, as are subscales
densityPlot(scales$orgatrct)
hist(scales$compete, breaks=20)
densityPlot(scales$compete)
hist(scales$socresp, breaks=20)
densityPlot(scales$socresp)
hist(scales$support, breaks=20)
hist(scales$innovate, breaks=20)
densityPlot(scales$innovate)
# QQ plot
scales.no.na <- na.omit(scales)
lm1 <- lm(orgatrct ~ AVI.id, data=scales.no.na)
plot(orgatrct ~ AVI.id, data=scales.no.na)
plot(lm1)
lm2 <- lm(orgjust ~ AVI.id, data=scales.no.na)
plot(orgjust ~ AVI.id, data=scales.no.na)
plot(lm2)
summary(lm3)
lm3 <- lm(innovate ~ AVI.id, data= scales.no.na)
plot(innovate ~ AVI.id, data=scales.no.na)
plot(lm3)
plot(orgatrct ~ jitter(innovate,2), data=scales.no.na)
abline(collinear, col="red")
## investigate collinearity   #Def some issues to address here ## still need VIF
collinear <- lm(orgjust ~ innovate, data=scales.no.na)
plot(orgatrct ~ jitter(innovate,2), data=scales.no.na)
abline(collinear, col="red")
plot(collinear)
plot(collinear1)
collinear1 <- lm(orgjust ~ compete, data=scales.no.na)
plot(collinear1)
collinear2 <- lm(orgjust ~ support, data=scales.no.na)
plot(orgjust ~ jitter(support,2), data=scales.no.na)
abline(collinear2, col="red")
plot(collinear2)
car::vif(vif)
vif <- lm(orgjust ~ AVI.id + compete + support + socresp + innovate, data=scales)
car::vif(vif)
#import data
items <- read.csv("data/cleaned_itemdata.long.csv", header=TRUE)
scales <- read.csv("data/cleaned_scaledata_long.csv", header=TRUE)
#libraries
library(psych)
View(items)
items.wide <- read.csv("data/cleaned_itemdata.wide.csv", header=TRUE)
View(items.wide)
#test-retest
testRetest(as.data.frame(items.wide[,1:18]), as.data.frame(items.wide[,50:67]))
#test-retest
cor(as.data.frame(items.wide[,1:18]), as.data.frame(items.wide[,50:67]))
