#libraries                  ##### NEEDS TO BE UPDATED #####
library(psych)
library(car)
library(dplyr)
library(ggplot2)
library(apaTables)
library(corrplot)
library(Hmisc)
library(ggcorrplot)

#import data
scales <- read.csv("prelim_data/cleaned_scaledata_long.csv", header=TRUE)


"##########################
DATA ANALYSIS:
descriptive stats (correlations across and between conditions)
t-test
regression
ANOVA
mediation
###########################"

##### first, create data subsets for analyses #####
corr.df <- scales[,3:13] #df for cor's across conditions

corr.df.AVI <- scales[scales$condition == "AVI",]
corr.df.AVI <- corr.df.AVI[,3:13]  ##df for cor's for AVI cond

corr.df.trad <- scales[scales$condition == "Traditional",]
corr.df.trad <- corr.df.trad[,3:13]  ##df for cor's for AVI cond


##### descriptive statistics (correlations across and between conditions) #####
corr.matrix <- round(cor(corr.df),2) 
ggcorrplot(corr.matrix, lab=TRUE) #everything is positively correlated with everything

corr.matrix.AVI <- round(cor(corr.df.AVI),2) 
ggcorrplot(corr.matrix.AVI, lab=TRUE)

corr.matrix.trad <- round(cor(corr.df.trad),2) 
ggcorrplot(corr.matrix.trad, lab=TRUE)

apa.cor.table(corr.df, filename = "output/test.doc", table.number = 3, show.conf.interval = FALSE, landscape = TRUE) #APA formatted table

rm(cor, corr.df, corr.df.AVI, corr.df.trad, corr.matrix, corr.matrix.AVI, corr.matrix.trad)


##### t-tests #####   
"in progress. unable to conduct t-test when sample size is not equal between groups"

desc_orgjust <- scales %>% 
  group_by(condition) %>% 
  summarise(count = length(orgjust),
            means= mean(orgjust),
            SDs = sd(orgjust))
desc_orgatrct <- scales %>% 
  group_by(condition) %>% 
  summarise(count = length(orgatrct),
            means= mean(orgatrct),
            SDs = sd(orgatrct))
desc_orgjust
desc_orgatrct

t.test(orgjust ~ condition, data=scales, paired=TRUE, var.equal=TRUE)

rm(desc_cond, desc_orgatrct, desc_orgjust)


###### regression ######
mod1 <- lm(orgatrct ~ condition, data = scales) #see stats notes for categorical predictor
summary(mod1)


###### ANOVA #####
aov1<- aov(orgatrct ~ condition, data = scales)
summary.aov(aov1)


##### mediation #####
