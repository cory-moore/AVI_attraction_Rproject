#libraries
library(dplyr)


### IMPORT the dataset 'visual.csv'  
## select header=TRUE and stringsAsFactors=TRUE
## imports categorical variables (target, distractor, number) as factors
visual <- read.csv("data/visual.csv", header=TRUE, stringsAsFactors = TRUE)


#view data
View(visual)
glimpse(visual)


"are there statistically significant differences on combined scores between levels of each 
 factor: target(absent or present), Distractor(O or Y), Number(few or many)"

###########################
## fit one-way ANOVA models 
###########################

## aov() function is similar to the regression lm() function we used earlier in the semester. 
## it goes like this: aov(DV ~ IV, data = name of the dataframe)

## DV = MeanScore, IV = Target absence or presence
aov1 <- aov(MeanScore ~ Target, data=visual)
summary(aov1)


## DV = MeanScore, IV = Distractor O's or Y's
aov2 <- aov(MeanScore ~ Distractor, data=visual)
summary(aov2)


## DV = MeanScore, IV = Number few or many
aov3 <- aov(MeanScore ~ Number, data=visual)
summary(aov3)

## What did you find? Were any of the main effects significant? Which ones? 


"Next, we will do two- and three-way ANOVAs by adding additional factors (IVs) and interactions.
 But first, lets plot the interactions for those upcoming ANOVA models"


###########################
## Interaction plots 
###########################

# this creates a new dataframe containing only trials with few distractors
# used in the following interaction plot
few <- visual %>% filter(Number == "few")

# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = few$Target, #x-axis variable
                 trace.factor = few$Distractor, #variable for lines
                 response = few$MeanScore, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
                 xlab = "Target (Absent or Present)", #x-axis label
                 trace.label = "Distractor", #legend label
                 main = "Interaction plot: Target x Distractor (when Number = few)", #main title
                 col = c("red", "blue")) #adds color to the lines


# this creates a new dataframe containing only trials with many distractors
# used in the following interaction plot
many <- visual %>% filter(Number == "many")

# plots the interaction for Distractor x Target (when Number = many)
interaction.plot(x.factor = many$Target, #x-axis variable
                 trace.factor = many$Distractor, #variable for lines
                 response = many$MeanScore, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
                 xlab = "Target (Absent or Present)", #x-axis label
                 trace.label = "Distractor", #Legend label
                 main = "Interaction plot: Target x Distractor (when Number = many)", #main title
                 col = c("red", "blue")) #adds color to the lines



## Nice job!! Let's look at the plots in another way by rearranging x-axis, trace, and grouping

# this creates a new dataframe containing only trials with few distractors
# used in the following interaction plot
absent <- visual %>% filter(Target == "absent")

# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = absent$Distractor, #x-axis variable
                 trace.factor = absent$Number, #variable for lines
                 response = absent$MeanScore, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
                 xlab = "Distractor (O or Y)", #x-axis label
                 trace.label = "Number", #legend label
                 main = "Interaction plot: Distractor x Number (Target = absent)", #maintitle
                 col = c("red", "blue")) #adds color to the lines


# this creates a new dataframe containing only trials with many distractors
# used in the following interaction plot
present <- visual %>% filter(Target == "present")

# plots the interaction for Distractor x Target (when Number = few)
interaction.plot(x.factor = present$Distractor, #x-axis variable
                 trace.factor = present$Number, #variable for lines
                 response = present$MeanScore, #y-axis variable
                 fun = mean, #metric to plot
                 ylab = "Combined Score (Accuracy * Confidence)", #y-axis label
                 xlab = "Distractor (O or Y)", #x-axis label
                 trace.label = "Number", #legend label
                 main = "Interaction plot: Distractor x Number (Target = present)", #maintitle
                 col = c("red", "blue")) #adds color to the lines



"After having seen some interaction in our plots, lets run the three-way ANOVAs. 
 
2x2x2 factorial design: add all three IVs to ANOVA model. Results include main effects of each IV and interaction terms between IVs"


#############################
## fit three-way ANOVA models
#############################

# notice the use of the asterisk (*) between IVs. this instructs R to compute interaction terms
# in addition to main effects. it goes: aov(DV ~ IV * IV * IV, data = name of df)
aov4 <- aov(MeanScore ~ Target * Distractor * Number, data=visual)
summary(aov4)


## How do you interpret these results?? How do these results add to our interpretation of the
## interaction plots??


## This is complex stuff! 


