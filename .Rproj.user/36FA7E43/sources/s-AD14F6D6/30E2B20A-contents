# libraries 
library(psych)
library(tidyverse)

###### Dependent Samples t Test ######_________

#import data 
data <- read.csv("rorschach.new.csv", header=TRUE)
data$condition <- factor(data$condition)


#inspect data using aggregate 
aggregate(attractiveness~condition, data = data, mean)
aggregate(attractiveness~condition, data = data, sd)
aggregate(attractiveness~condition, data = data, length)

#alternative method for getting count, mean, and sd in a slightly more sophisticated way 
descriptive_data <- data %>% 
  group_by(condition) %>% 
  summarise(count = length(attractiveness),
            means= mean(attractiveness),
            SDs = sd(attractiveness))
descriptive_data


#plot data
boxplot(data$attractiveness ~ data$condition, 
        col='steelblue',
        main='Attractiveness Scores by condition',
        xlab='condition',
        ylab='Attractiveness Score')

#alternative way to plot the same boxplots
ggplot(data, aes(x=condition, y=attractiveness, fill=condition)) +
  geom_boxplot() +
  ggtitle("Attrativeness Scores by condition")


# t test --- paired argument tells R to use one sample t-test
t.test(attractiveness ~ condition, data=data, paired=TRUE, var.equal=TRUE)
