# libraries 
library(psych)
library(tidyverse)

###### Independent Samples t Test ######__________

#import data
counsel <- read.csv("counsel.csv", header=TRUE)

counseling <- read.csv("counseling.csv", header=TRUE) #demonstration purposes only
rm(counseling)

#make 'group' a factor (categorical) variable
counsel$group <- factor(counsel$group)
levels(counsel$group) <- c("treatment", "control")


#inspect data using aggregate  #tips for using aggregate() ---> https://r-coder.com/aggregate-r/  
aggregate(adjust~group, data = counsel, mean)
aggregate(adjust~group, data = counsel, sd)
aggregate(adjust~group, data = counsel, length)

#alternative method for getting count, mean, and sd in a slightly more sophisticated way 
descriptive_counsel <- counsel %>% 
  group_by(group) %>% 
  summarise(count = length(adjust),
            means= mean(adjust),
            SDs = sd(adjust))
descriptive_counsel
 

#plot data
boxplot(counsel$adjust ~ counsel$group, 
        col='steelblue',
        main='Adjustment Scores by Group',
        xlab='Group',
        ylab='Adjustment Score')

#alternative way to plot the same boxplots
ggplot(counsel, aes(x=group, y=adjust, fill=group)) +
  geom_boxplot() +
  ggtitle("Adjustment Scores by Group")


# t test --- var.equal argument tells R to use the two sample t-test
t.test(adjust ~ group, data=counsel, var.equal=TRUE)



###### Dependent Samples t Test ######_________

#import data 
movie <- read.csv("movie.csv", header=TRUE)
movie$group <- factor(movie$group)
levels(movie$group) <- c("pretest", "posttest")


#inspect data using aggregate 
aggregate(attitude~group, data = movie, mean)
aggregate(attitude~group, data = movie, sd)
aggregate(attitude~group, data = movie, length)

#alternative method for getting count, mean, and sd in a slightly more sophisticated way 
descriptive_movie <- movie %>% 
  group_by(group) %>% 
  summarise(count = length(attitude),
            means= mean(attitude),
            SDs = sd(attitude))
descriptive_movie


#plot data
boxplot(movie$attitude ~ movie$group, 
        col='steelblue',
        main='Attitude Scores by Group',
        xlab='Group',
        ylab='Attitude Score')

#alternative way to plot the same boxplots
ggplot(movie, aes(x=group, y=attitude, fill=group)) +
  geom_boxplot() +
  ggtitle("Attitude Scores by Group")


# t test --- paired argument tells R to use one sample t-test
t.test(attitude ~ group, data=movie, paired=TRUE, var.equal=TRUE)

